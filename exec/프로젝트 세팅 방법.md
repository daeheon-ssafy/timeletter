## ğŸ“š ì¤€ë¹„í•˜ê¸°

> DB ìƒì„±í•˜ê³  ì„¤ì • íŒŒì¼ application.properties(ë°±ì—”ë“œ), .env(í”„ë¡ íŠ¸ì—”ë“œ) íŒŒì¼ ìƒì„± ë° ì¶”ê°€í•˜ì‹œë©´ ë©ë‹ˆë‹¤

1. Git clone ë°›ê¸°

```
git clone https://lab.ssafy.com/s04-bigdata-sub3/s04p23d106.git
```

2. ë°ì´í„°ë² ì´ìŠ¤ ì¤€ë¹„

- 'timeletter' í…Œì´í„°ë² ì´ìŠ¤ ìƒì„±

```
CREATE SCHEMA `timeletter`;
```

-  í•„ìš”í•œ í…Œì´ë¸” ìƒì„±

[Database Tables](.docs/DBTable.sql)

3. [**Backend**] application.properties ì„¤ì •

- backend\src\main\resources í´ë” ì•„ë˜ ìƒì„±í•˜ì‹œë©´ ë©ë‹ˆë‹¤
- mysql ë„ë©”ì¸ê³¼ ì•„ì´ë””/ë¹„ë²ˆ ì‘ì„±

```
server:
	servlet:
		context-path: /timeletter

# fileupload 
spring:
	servlet:
		multipart:
			enabled:true
			max-file-size:500MB
			max-request-size:500MB
	datasource:
        driver-class-name: com.mysql.cj.jdbc.Driver
        url: jdbc:mysql://k4d105.p.ssafy.io/timeletter?serverTimeZone=UTC&CharacterEncoding=UTF-8
        username: caterpie
        password: password
	jpa:
        hibernate:
        	ddl-auto: none
        show-sql: false
        properties:
        	hibernate:
        		format_sql: true        
       
# jwt
jwt:
  header: Authorization
  secret: dGltZWxldHRlci1pcy1hLXNsb3ctbWVzc2FuZ2VyLXBsYXRmb3JtLXNlcnZpY2VkLWJ5LXRlYW0tY2F0ZXJwaWUtc2luY2UtMjAyMS1hbGwtcmlnaHRzLXJlc2VydmVkLWF0LWNhdGVycGllCg==
  token-validity-in-seconds: 86400

# logging
logging:
  level:
    com.caterpie: DEBUG
```

4. [Frontend] .env ì‘ì„±

- frontend í´ë” ì•„ë˜ ìƒì„±í•˜ì‹œë©´ ë©ë‹ˆë‹¤
- nginxì— ëª…ì‹œëœ locationì„ ë”°ë¼ê°‘ë‹ˆë‹¤

```
React_APP_SERVER_URL={ë„ë©”ì¸ì£¼ì†Œ}
React_APP_SPRING_URL={ë„ë©”ì¸ì£¼ì†Œ}/timeletter
React_APP_STORAGE_URL={ë„ë©”ì¸ì£¼ì†Œ}/videos
```

5. [Frontend] ëª¨ë“ˆ ë‹¤ìš´ë¡œë“œ

```
# frontend í´ë”ë¡œ ì´ë™í•´ì„œ ë‹¤ìš´
cd frontend/
npm install
```

6. [Backend] (Option) Spring bootë¥¼ build(jar íŒŒì¼ ìƒì„±)

```
# backend í´ë”ë¡œ ì´ë™í•´ì„œ Spring boot jar íŒŒì¼ ìƒì„±
cd backend/build/libs
./gradlew bootJar
```

<br />



## ğŸ ì‹¤í–‰í•˜ê¸°

1. ë°±ì—”ë“œ ì‹¤í–‰

- ìƒì„±í•œ jar íŒŒì¼ ì‹¤í–‰

```
java -jar [filename].jar //timeletter.jar
```

- í˜¹ì€ war íŒŒì¼ ìƒì„±í•˜ì§€ ì•Šê³  demonìœ¼ë¡œ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•˜ê³  ì‹¶ë‹¤ë©´ STSì™€ ê°™ì€ IDEAì—ì„œ Spring boot Runì„ ì‹¤í–‰í•˜ê±°ë‚˜ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‹¤í–‰

```
mvn spring-boot:run
```

2. í”„ë¡ íŠ¸ì—”ë“œ ì‹¤í–‰

* íŒ¨í‚¤ì§€ ì„¤ì¹˜

```
$ npm i
```

* React ì‹¤í–‰

```
npm start
```

<br/>



## ğŸ–¥ ë°°í¬í•˜ê¸°

í•´ë‹¹ ì„œë¹„ìŠ¤ëŠ” AWS EC2ë¥¼ í†µí•´ ë°°í¬í•˜ì˜€ê³ 
Dockerì™€ Jenkinsë¥¼ ì´ìš©í•´ CI/CD êµ¬ì¶•í•˜ì˜€ìŠµë‹ˆë‹¤:

1. AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (ubuntu)
2. docker ì„¤ì¹˜
3. í•„ìš”í•œ ì´ë¯¸ì§€ë¥¼ docker hubë¥¼ í†µí•´ ì„¤ì¹˜
   1. Jenkins
   2. MySQL
4. docker-compose.yml ì‘ì„±(services - `jenkins`, `db`, `frontend`  network: `caterpie`)
5. Jenkinsì™€ Gitlab repository ì—°ë™
6. MySQL ì»¨í…Œì´ë„ˆì— `timeletter` DB ìŠ¤í‚¤ë§ˆ ìƒì„±
7. Nginx ì„¤ì • (frontend/nginx í´ë”ì˜ default.conf)
8. frontend, backend í´ë” ì•ˆì— dockerfile ì‘ì„±
9. í”„ë¡œì íŠ¸ root ìœ„ì¹˜ì— Jenkins íŒŒì¼ ì‘ì„±
   1. Build and Test ê³¼ì •
   2. Build (frontend, backend)
   3. Run (ì»¨í…Œì´ë„ˆ ì‹¤í–‰)
10. `docker ps` ë¥¼ í†µí•´ frontend, backend, django ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸ (Jenkins, MySQL í¬í•¨)

<br/>